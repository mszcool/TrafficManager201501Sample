DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'TrafficManagerWeb.Library.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201501231555198_InitialSetup'
BEGIN
    CREATE TABLE [dbo].[LogEntities] (
        [LogId] [int] NOT NULL IDENTITY,
        [LogDate] [datetime] NOT NULL,
        [LogSiteSource] [nvarchar](max) NOT NULL,
        [LogSiteRegion] [nvarchar](max) NOT NULL,
        [LogMessage] [nvarchar](max) NOT NULL,
        CONSTRAINT [PK_dbo.LogEntities] PRIMARY KEY ([LogId])
    )
    CREATE INDEX [IX_LogDate] ON [dbo].[LogEntities]([LogDate])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201501231555198_InitialSetup', N'TrafficManagerWeb.Library.Migrations.Configuration',  0x1F8B0800000000000400CD58DB6EE336107D2FD07F10F8D4025933979736907791DA4961344E82C8BB7DA6A59142942255920AEC6FEB433FA9BFD0A1EE967CCD66D1C22F123973E6C6331CF99FBFFEF63FAD52E1BD82365CC931B9189D130F64A8222E9331C96DFCE127F2E9E3F7DFF9B751BAF2BED472574E0E35A51993176BB36B4A4DF8022933A394875A1915DB51A852CA22452FCFCF7FA617171410822096E7F9CFB9B43C85E2055F274A8690D99C89B98A40986A1D778202D57B6029988C8530260BCDE2988773265902FA77588EEEF95233BD1E4D9965376108C610EF467086BE052062E231299565163DBFFE6C20B05AC924C8708189C53A03948B9930504574DD8A1F1BDCF9A50B8EB68A3554981BABD213012FAEAA6CD1BEFA9B724E9A6C623E6F31EF76EDA22E723A26F72A29D788D7B7763D11DA49EECB79A1CBC18C1A9C336FA7F4597380F09CB9DF9937C985CD358C25E4563371E63DE54BC1C3DF60BD507F801CCB5C886E001802EE6D2CE0D293561968BB7E86B80D6B16118F6EAAD2BE6EA3B9A956463D93F6EA92780FE8025B0A684E49274381551A7E05099A59889E98B5A0B1C8B308AA9CD243E6F0D0426DD03D2F90165B6C1EC409B88540E53A6CD0F09C2389893767AB7B90897D19137C24DE1D5F4154AF54F09F2547CEA392D5F9B1D69E21298EE4B7B736474AE3517A67533E6DC930A408B624CB3816B67223F85394D562D3A5DB8395DDC2186C2F15694C657233B6123B00BBC13E8D04225EEB4DD9B7461D6A6EF3BBF1B0ED96B46C97755BA53BFAAA3F67598629ECF4D96AC50BCA263BF9109CDE6BD2128386664BCB69BC6D2C2175B0A8BD5D348D9EDE716DACCBF592B9224EA27420B6AD1E3B725D5B1CA4BCDF46DA0AD42AEEB9543BE6DAE954AC07DD66F80E834EB13B14F143E363B7110F748B7B9009A6B777AB8912792AF7F4BD0318650BEAA1948B27E1745B500FADBB753266DD68B660D65B276136EDA407D8AC0FD17CDA2B5FFFE8D0C1D9E9DD3CFDD3B88FD07D91C67A43EC1E81FD8A4C87A7A701BB4A11E2619A5E7954306B6D2CA4C5B11E21CB268263BCAD003280C7606C793F131C572E7BE3D6FF67F4A1C644E2D8F9E73F9A32B84BEEC139E2F481A03B5844F86CDF6DB090AF4C872F4CFF90B2D58F5DC8370F0F5F8BD81B104E803B6D0818DE4DC75CEF4501F7DDEE2507B14C4B852194AED6DBC568F0C6EB7FD8157CDAFDF2F2A76078D242B8EF3009A1A35B0B5ACBCC64ACEACC63845D8F6A915E61E66059E42E476D79CC428BDBEE962C66B72F4CE428729B2E219AC9C7DC66B9BD3106D2A5D818777CBADF7E31E36CFAEC3F66EECDBC4708E82677E47994BFE45C448DDF7743F2EC827067A662367A85B32BC225EB06E941C92381AAF44D2103E9FAC202D24C20987994017B85B7F886E3EA3D242C5CD7CD7D37C8E1426CA6DD9F729668969A0AA3D577FF2650F777C2C77F014B98D38B80100000 , N'6.1.2-31219')
END

